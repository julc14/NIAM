@using NameItAfterMe.Application.Domain
<OverlayTabTemplate >

    <MudSelect T="string" Value=@_currentStory?.Name ValueChanged="(story) => _currentStory = _stories?.FirstOrDefault(x => x.Name == story)">
        @foreach (var story in _stories ?? Enumerable.Empty<StoryDto>())
        {
            <MudSelectItem Value=story.Name />
        }
    </MudSelect>

    <MudForm>
        <MudGrid Style="margin:20px">
            @foreach (var word in _currentStory?.WordDescriptor ?? Enumerable.Empty<string>())
            {
                <MudItem xs="4">
                    <MudTextField T="string" Label="@word" Required="true" />
                </MudItem>
            }
        </MudGrid>
    </MudForm>

</OverlayTabTemplate >

@code {
    private IEnumerable<StoryDto>? _stories;
    private StoryDto? _currentStory;

    [Inject]
    public HttpClient HttpClient { get; set; } = null!;

    protected override async Task OnInitializedAsync()
    {
        // todo: low frequency changes to db content, cache client side?
        _stories = await HttpClient.GetFromJsonAsync(new GetStories());
    }
}
